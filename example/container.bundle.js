(()=>{"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?e(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):e(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function _(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _(e)}function a(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var o=l(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return s(this,n)}}function f(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}function p(){return p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=f(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},p.apply(this,arguments)}var h,d,v,y,b,m=function(){function e(){n(this,e),this.listeners={}}return o(e,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){var n=this.listeners[e]||[],r=n.indexOf(t);-1!==r&&n.splice(r,1)}},{key:"emit",value:function(e,t){var n=this;(this.listeners[e]||[]).forEach((function(e){e.call(n,t)}))}}]),e}(),g=function(e){u(r,e);var t=a(r);function r(){var e;return n(this,r),(e=t.call(this)).token=`dispatch${Math.random()}`,Object.assign(_(e),{_isDispatching:!1,dispatch:e.dispatch.bind(_(e)),register:e.addEventListener.bind(_(e),e.token),unregister:e.removeEventListener.bind(_(e),e.token)}),e}return o(r,[{key:"isDispatching",value:function(){return this._isDispatching}},{key:"dispatch",value:function(e){if(this._isDispatching)throw new Error("can't dispatch in the middle of a dispatch");this._isDispatching=!0,this.emit(this.token,e),this._isDispatching=!1}}]),r}(m),k=function(e){u(i,e);var r=a(i);function i(e,o){var u;return n(this,i),u=r.call(this),Object.assign(_(u),{dispatcher:e,opts:o,CHANGE:"change",state:t({},u.state||{})}),e.register((function(e){u._changed=!1,u._invoke(e)})),u}return o(i,[{key:"getState",value:function(){return this.state}},{key:"addListener",value:function(e){var t=this;return this.addEventListener(this.CHANGE,e),{remove:function(){return t.removeEventListener(t.CHANGE,e)}}}},{key:"getDispatcher",value:function(){return this.dispatcher}},{key:"hasChanged",value:function(){return this._changed}},{key:"_invoke",value:function(e){this.__onDispatch(e),this._changed&&this.emit(this.CHANGE)}},{key:"__emitChange",value:function(){this._changed=!0}}]),i}(m),O=function(e){u(i,e);var r=a(i);function i(e,o){var u;return n(this,i),(u=r.call(this,e,o)).state=t({},u.state||{}),u}return o(i,[{key:"areEqual",value:function(e,t){return e===t}},{key:"_invoke",value:function(e){var t=this.reduce(this.state,e);if(!t)throw new Error("reduce() must not return undefined");this.areEqual(this.state,t)||(this.state=t,this.__emitChange(),this.emit(this.CHANGE))}}]),i}(k),w={},P=[],S=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function j(e,t){for(var n in t)e[n]=t[n];return e}function E(e){var t=e.parentNode;t&&t.removeChild(e)}function D(e,t,n){var r,o,i,u={};for(i in t)"key"==i?r=t[i]:"ref"==i?o=t[i]:u[i]=t[i];if(arguments.length>2&&(u.children=arguments.length>3?h.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(i in e.defaultProps)void 0===u[i]&&(u[i]=e.defaultProps[i]);return x(e,u,r,o,null)}function x(e,t,n,r,o){var i={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==o?++v:o};return null==o&&null!=d.vnode&&d.vnode(i),i}function C(e){return e.children}function R(e,t){this.props=e,this.context=t}function L(e,t){if(null==t)return e.__?L(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?L(e):null}function T(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return T(e)}}function A(e){(!e.__d&&(e.__d=!0)&&y.push(e)&&!N.__r++||b!==d.debounceRendering)&&((b=d.debounceRendering)||setTimeout)(N)}function N(){for(var e;N.__r=y.length;)e=y.sort((function(e,t){return e.__v.__b-t.__v.__b})),y=[],e.some((function(e){var t,n,r,o,i,u;e.__d&&(i=(o=(t=e).__v).__e,(u=t.__P)&&(n=[],(r=j({},o)).__v=o.__v+1,I(u,o,r,t.__n,void 0!==u.ownerSVGElement,null!=o.__h?[i]:null,n,null==i?L(o):i,o.__h),$(n,o),o.__e!=i&&T(o)))}))}function U(e,t,n,r,o,i,u,l,c,_){var s,a,f,p,h,d,v,y=r&&r.__k||P,b=y.length;for(n.__k=[],s=0;s<t.length;s++)if(null!=(p=n.__k[s]=null==(p=t[s])||"boolean"==typeof p?null:"string"==typeof p||"number"==typeof p||"bigint"==typeof p?x(null,p,null,null,p):Array.isArray(p)?x(C,{children:p},null,null,null):p.__b>0?x(p.type,p.props,p.key,p.ref?p.ref:null,p.__v):p)){if(p.__=n,p.__b=n.__b+1,null===(f=y[s])||f&&p.key==f.key&&p.type===f.type)y[s]=void 0;else for(a=0;a<b;a++){if((f=y[a])&&p.key==f.key&&p.type===f.type){y[a]=void 0;break}f=null}I(e,p,f=f||w,o,i,u,l,c,_),h=p.__e,(a=p.ref)&&f.ref!=a&&(v||(v=[]),f.ref&&v.push(f.ref,null,p),v.push(a,p.__c||h,p)),null!=h?(null==d&&(d=h),"function"==typeof p.type&&p.__k===f.__k?p.__d=c=M(p,c,e):c=H(e,p,f,y,h,c),"function"==typeof n.type&&(n.__d=c)):c&&f.__e==c&&c.parentNode!=e&&(c=L(f))}for(n.__e=d,s=b;s--;)null!=y[s]&&("function"==typeof n.type&&null!=y[s].__e&&y[s].__e==n.__d&&(n.__d=L(r,s+1)),z(y[s],y[s]));if(v)for(s=0;s<v.length;s++)V(v[s],v[++s],v[++s])}function M(e,t,n){for(var r,o=e.__k,i=0;o&&i<o.length;i++)(r=o[i])&&(r.__=e,t="function"==typeof r.type?M(r,t,n):H(n,r,r,o,r.__e,t));return t}function H(e,t,n,r,o,i){var u,l,c;if(void 0!==t.__d)u=t.__d,t.__d=void 0;else if(null==n||o!=i||null==o.parentNode)e:if(null==i||i.parentNode!==e)e.appendChild(o),u=null;else{for(l=i,c=0;(l=l.nextSibling)&&c<r.length;c+=2)if(l==o)break e;e.insertBefore(o,i),u=i}return void 0!==u?u:o.nextSibling}function W(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||S.test(t)?n:n+"px"}function F(e,t,n,r,o){var i;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||W(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||W(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])i=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+i]=n,n?r||e.addEventListener(t,i?G:B,i):e.removeEventListener(t,i?G:B,i);else if("dangerouslySetInnerHTML"!==t){if(o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null!=n&&(!1!==n||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,n):e.removeAttribute(t))}}function B(e){this.l[e.type+!1](d.event?d.event(e):e)}function G(e){this.l[e.type+!0](d.event?d.event(e):e)}function I(e,t,n,r,o,i,u,l,c){var _,s,a,f,p,h,v,y,b,m,g,k,O,w=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(c=n.__h,l=t.__e=n.__e,t.__h=null,i=[l]),(_=d.__b)&&_(t);try{e:if("function"==typeof w){if(y=t.props,b=(_=w.contextType)&&r[_.__c],m=_?b?b.props.value:_.__:r,n.__c?v=(s=t.__c=n.__c).__=s.__E:("prototype"in w&&w.prototype.render?t.__c=s=new w(y,m):(t.__c=s=new R(y,m),s.constructor=w,s.render=J),b&&b.sub(s),s.props=y,s.state||(s.state={}),s.context=m,s.__n=r,a=s.__d=!0,s.__h=[]),null==s.__s&&(s.__s=s.state),null!=w.getDerivedStateFromProps&&(s.__s==s.state&&(s.__s=j({},s.__s)),j(s.__s,w.getDerivedStateFromProps(y,s.__s))),f=s.props,p=s.state,a)null==w.getDerivedStateFromProps&&null!=s.componentWillMount&&s.componentWillMount(),null!=s.componentDidMount&&s.__h.push(s.componentDidMount);else{if(null==w.getDerivedStateFromProps&&y!==f&&null!=s.componentWillReceiveProps&&s.componentWillReceiveProps(y,m),!s.__e&&null!=s.shouldComponentUpdate&&!1===s.shouldComponentUpdate(y,s.__s,m)||t.__v===n.__v){s.props=y,s.state=s.__s,t.__v!==n.__v&&(s.__d=!1),s.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),s.__h.length&&u.push(s);break e}null!=s.componentWillUpdate&&s.componentWillUpdate(y,s.__s,m),null!=s.componentDidUpdate&&s.__h.push((function(){s.componentDidUpdate(f,p,h)}))}if(s.context=m,s.props=y,s.__v=t,s.__P=e,g=d.__r,k=0,"prototype"in w&&w.prototype.render)s.state=s.__s,s.__d=!1,g&&g(t),_=s.render(s.props,s.state,s.context);else do{s.__d=!1,g&&g(t),_=s.render(s.props,s.state,s.context),s.state=s.__s}while(s.__d&&++k<25);s.state=s.__s,null!=s.getChildContext&&(r=j(j({},r),s.getChildContext())),a||null==s.getSnapshotBeforeUpdate||(h=s.getSnapshotBeforeUpdate(f,p)),O=null!=_&&_.type===C&&null==_.key?_.props.children:_,U(e,Array.isArray(O)?O:[O],t,n,r,o,i,u,l,c),s.base=t.__e,t.__h=null,s.__h.length&&u.push(s),v&&(s.__E=s.__=null),s.__e=!1}else null==i&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=q(n.__e,t,n,r,o,i,u,c);(_=d.diffed)&&_(t)}catch(e){t.__v=null,(c||null!=i)&&(t.__e=l,t.__h=!!c,i[i.indexOf(l)]=null),d.__e(e,t,n)}}function $(e,t){d.__c&&d.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){d.__e(e,t.__v)}}))}function q(e,t,n,r,o,i,u,l){var c,_,s,a=n.props,f=t.props,p=t.type,d=0;if("svg"===p&&(o=!0),null!=i)for(;d<i.length;d++)if((c=i[d])&&"setAttribute"in c==!!p&&(p?c.localName===p:3===c.nodeType)){e=c,i[d]=null;break}if(null==e){if(null===p)return document.createTextNode(f);e=o?document.createElementNS("http://www.w3.org/2000/svg",p):document.createElement(p,f.is&&f),i=null,l=!1}if(null===p)a===f||l&&e.data===f||(e.data=f);else{if(i=i&&h.call(e.childNodes),_=(a=n.props||w).dangerouslySetInnerHTML,s=f.dangerouslySetInnerHTML,!l){if(null!=i)for(a={},d=0;d<e.attributes.length;d++)a[e.attributes[d].name]=e.attributes[d].value;(s||_)&&(s&&(_&&s.__html==_.__html||s.__html===e.innerHTML)||(e.innerHTML=s&&s.__html||""))}if(function(e,t,n,r,o){var i;for(i in n)"children"===i||"key"===i||i in t||F(e,i,null,n[i],r);for(i in t)o&&"function"!=typeof t[i]||"children"===i||"key"===i||"value"===i||"checked"===i||n[i]===t[i]||F(e,i,t[i],n[i],r)}(e,f,a,o,l),s)t.__k=[];else if(d=t.props.children,U(e,Array.isArray(d)?d:[d],t,n,r,o&&"foreignObject"!==p,i,u,i?i[0]:n.__k&&L(n,0),l),null!=i)for(d=i.length;d--;)null!=i[d]&&E(i[d]);l||("value"in f&&void 0!==(d=f.value)&&(d!==e.value||"progress"===p&&!d||"option"===p&&d!==a.value)&&F(e,"value",d,a.value,!1),"checked"in f&&void 0!==(d=f.checked)&&d!==e.checked&&F(e,"checked",d,a.checked,!1))}return e}function V(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){d.__e(e,n)}}function z(e,t,n){var r,o;if(d.unmount&&d.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||V(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){d.__e(e,t)}r.base=r.__P=null,e.__c=void 0}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&z(r[o],t,"function"!=typeof e.type);n||null==e.__e||E(e.__e),e.__=e.__e=e.__d=void 0}function J(e,t,n){return this.constructor(e,n)}function K(e){return K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K(e)}function Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e,t,n){return t&&X(e.prototype,t),n&&X(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Z(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ee(e,t)}function ee(e,t){return ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ee(e,t)}function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=oe(e);if(t){var o=oe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ne(this,n)}}function ne(e,t){if(t&&("object"===K(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return re(e)}function re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}function ie(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}h=P.slice,d={__e:function(e,t,n,r){for(var o,i,u;t=t.__;)if((o=t.__c)&&!o.__)try{if((i=o.constructor)&&null!=i.getDerivedStateFromError&&(o.setState(i.getDerivedStateFromError(e)),u=o.__d),null!=o.componentDidCatch&&(o.componentDidCatch(e,r||{}),u=o.__d),u)return o.__E=o}catch(t){e=t}throw e}},v=0,R.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=j({},this.state),"function"==typeof e&&(e=e(j({},n),this.props)),e&&j(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),A(this))},R.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),A(this))},R.prototype.render=C,y=[],N.__r=0;var ue=function(e){return(e+1)%3},le=function(e){Z(n,e);var t=te(n);function n(){var e;Q(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return ie(re(e=t.call.apply(t,[this].concat(o))),"state",{value:"...",step:0}),e}return Y(n,[{key:"reduce",value:function(e){var t=e.step;return{step:t=ue(t),value:t?"hello":"..."}}}]),n}(O),ce=function(e){Z(n,e);var t=te(n);function n(){var e;Q(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return ie(re(e=t.call.apply(t,[this].concat(o))),"state",{value:"",step:0}),e}return Y(n,[{key:"reduce",value:function(e){var t=e.step;return{step:t=ue(t),value:2===t?"world":""}}}]),n}(O),_e=new g,se=[new le(_e),new ce(_e)],ae=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.getStores,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.calculateState,c=function(c){u(f,c);var s=a(f);function f(e,o){var u;return n(this,f),u=s.call(this,e,o),Object.assign(_(u),{state:t(t({},u.state||{}),i(u.state,e,o)),stores:r(u.props,u.context),_onState:u._onState.bind(_(u))}),u}return o(f,[{key:"componentDidMount",value:function(){p(l(f.prototype),"componentDidMount",this)&&p(l(f.prototype),"componentDidMount",this).call(this),this._addStores()}},{key:"componentWillUnmount",value:function(){p(l(f.prototype),"componentWillUnmount",this)&&p(l(f.prototype),"componentWillUnmount",this).call(this),this._removeStores()}},{key:"_onState",value:function(){var e=this;this.setState((function(t,n){return i(t,n,e.context)}))}},{key:"_addStores",value:function(){var e=this;this._removers=this.stores.map((function(t){return t.addListener(e._onState)}))}},{key:"_removeStores",value:function(){this.__removers&&this.__removers.forEach((function(e){return e.remove()}))}}],[{key:"getDerivedStateFromProps",value:function(t,n){return"function"==typeof e.getDerivedStateFromProps?e.getDerivedStateFromProps(t,n):null}}]),f}(e);return c}(function(e){Z(n,e);var t=te(n);function n(){return Q(this,n),t.apply(this,arguments)}return Y(n,[{key:"render",value:function(){var e=this.state,t=e.step,n=e.value;return D("span",null,D("h1",null,"femto-flux connect example"),D("div",null,n),D("button",{onClick:function(){return _e.dispatch()}},"click #",t))}}],[{key:"getStores",value:function(){return se}},{key:"calculateState",value:function(){var e=se[0].getState().step;return{value:se.map((function(e){return e.getState().value})).join(" ").trim(),step:e}}}]),n}(R)),fe=document.createElement("div");document.body.insertBefore(fe,document.body.firstChild),function(e,t,n){var r,o,i;d.__&&d.__(e,t),o=(r="function"==typeof n)?null:n&&n.__k||t.__k,i=[],I(t,e=(!r&&n||t).__k=D(C,null,[e]),o||w,w,void 0!==t.ownerSVGElement,!r&&n?[n]:o?null:t.firstChild?h.call(t.childNodes):null,i,!r&&n?n:o?o.__e:t.firstChild,r),$(i,e)}(D(ae,null),fe)})();